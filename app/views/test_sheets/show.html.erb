<div class="min-h-screen bg-white" data-controller="print">
  <!-- ÁîªÈù¢Ë°®Á§∫Áî®„Éò„ÉÉ„ÉÄ„ÉºÔºàÂç∞Âà∑ÊôÇ„ÅØÈùûË°®Á§∫Ôºâ -->
  <div class="no-print border-b border-gray-200 bg-gray-50 px-6 py-4">
    <div class="mx-auto flex max-w-4xl items-center justify-between">
      <div>
        <h1 class="text-2xl font-bold text-gray-900">„ÉÜ„Çπ„ÉàË°®Á§∫</h1>
        <p class="mt-1 text-sm text-gray-600">
          <%= format_test_created_at(@test_sheet) %> ‰ΩúÊàê
        </p>
      </div>
      <div class="flex gap-3">
        <%= link_to "Êàª„Çã", new_test_sheet_path, class: "rounded-lg bg-gray-600 px-4 py-2 text-white transition-colors hover:bg-gray-700" %>
        <button 
          data-action="click->print#execute"
          class="rounded-lg bg-blue-600 px-6 py-2 font-bold text-white transition-colors hover:bg-blue-700">
          üñ®Ô∏è Âç∞Âà∑„Åô„Çã
        </button>
      </div>
    </div>
  </div>

  <!-- Âç∞Âà∑Áî®„Ç≥„É≥„ÉÜ„É≥„ÉÑ -->
  <div class="print-content mx-auto max-w-4xl p-8">
    <!-- „ÉÜ„Çπ„Éà„Éò„ÉÉ„ÉÄ„Éº -->
    <div class="mb-8 border-b-2 border-gray-300 pb-6">
      <div class="mb-4 flex items-start justify-between">
        <div>
          <h2 class="mb-2 text-3xl font-bold text-gray-900">
            <%= @test_sheet.subject.name %> - <%= @test_sheet.unit.name %>
          </h2>
          <p class="text-lg text-gray-600">
            <%= difficulty_label_for_display(@test_sheet) %> / 
            ÂÖ®<%= @test_sheet.question_count %>Âïè
          </p>
        </div>
        <div class="text-right">
          <div class="mb-2">
            <span class="text-sm text-gray-600">Â≠¶Âπ¥:</span>
            <span class="text-lg font-bold">È´ò<%= @test_sheet.unit.grade %></span>
          </div>
          <div>
            <span class="text-sm text-gray-600">‰ΩúÊàêÊó•:</span>
            <span class="text-sm"><%= format_test_created_at(@test_sheet) %></span>
          </div>
        </div>
      </div>

      <!-- ÂêçÂâçË®òÂÖ•Ê¨Ñ -->
      <div class="flex gap-6">
        <div class="flex-1">
          <label class="mb-1 block text-sm font-medium text-gray-700">Ê∞èÂêç</label>
          <div class="name-line"></div>
        </div>
        <div class="w-32">
          <label class="mb-1 block text-sm font-medium text-gray-700">ÂæóÁÇπ</label>
          <div class="score-line"></div>
        </div>
      </div>
    </div>

    <!-- ÂïèÈ°å„É™„Çπ„Éà -->
    <div class="space-y-6">
      <% @questions.each do |test_question| %>
        <% question = test_question.question %>
        <div class="question-item border-b border-gray-200 pb-6">
          <!-- ÂïèÈ°åÁï™Âè∑„Å®ÂïèÈ°åÊñá -->
          <div class="flex gap-4">
            <div class="w-12 flex-shrink-0 text-right">
              <span class="text-xl font-bold text-gray-700">
                <%= question_number_label(test_question.question_order) %>
              </span>
            </div>
            <div class="flex-1">
              <p class="mb-2 text-lg text-gray-900">
                <%= question.question_text %>
              </p>

              <!-- „Éí„É≥„ÉàË°®Á§∫ -->
              <% if @test_sheet.include_hint? && question.hint.present? %>
                <p class="mb-2 text-sm italic text-gray-600">
                  üí° „Éí„É≥„Éà: <%= question.hint %>
                </p>
              <% end %>

              <!-- Ëß£Á≠îÊ¨Ñ -->
              <div class="mt-3">
                <span class="text-sm text-gray-600">Ëß£Á≠î:</span>
                <div class="answer-line"></div>
              </div>
            </div>
          </div>
        </div>
      <% end %>
    </div>

    <!-- Ëß£Á≠îÊ¨ÑÔºàinclude_answer „Åå true „ÅÆÂ†¥Âêà„ÅÆ„ÅøÔºâ -->
    <% if @test_sheet.include_answer? %>
      <div class="page-break-before mt-12 border-t-4 border-gray-300 pt-8">
        <h3 class="mb-6 text-2xl font-bold text-gray-900">Ëß£Á≠î</h3>
        <div class="grid grid-cols-2 gap-x-8 gap-y-3">
          <% @questions.each do |test_question| %>
            <% question = test_question.question %>
            <div class="flex items-baseline gap-3">
              <span class="w-8 text-right font-bold text-gray-700">
                <%= test_question.question_order %>.
              </span>
              <span class="text-gray-900">
                <%= question.answer_text %>
              </span>
              <% if question.answer_note.present? %>
                <span class="text-sm text-gray-500">
                  (<%= question.answer_note %>)
                </span>
              <% end %>
            </div>
          <% end %>
        </div>
      </div>
    <% end %>
  </div>
</div>
