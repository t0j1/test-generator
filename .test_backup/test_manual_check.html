<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>å˜å…ƒè¡¨ç¤ºãƒ†ã‚¹ãƒˆ - ä¿®æ­£ç¢ºèªç”¨</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://unpkg.com/@hotwired/stimulus@3.2.1/dist/stimulus.umd.js"></script>
  <style>
    .test-result {
      padding: 1rem;
      margin: 1rem 0;
      border-radius: 0.5rem;
    }
    .test-pass {
      background-color: #d1fae5;
      border: 2px solid #10b981;
      color: #065f46;
    }
    .test-fail {
      background-color: #fee2e2;
      border: 2px solid #ef4444;
      color: #991b1b;
    }
  </style>
</head>
<body class="bg-gray-50 p-8">
  <div class="max-w-6xl mx-auto">
    <h1 class="text-3xl font-bold text-gray-900 mb-6">å˜å…ƒè¡¨ç¤ºãƒ†ã‚¹ãƒˆ - ä¿®æ­£ç¢ºèªç”¨</h1>
    
    <div class="bg-blue-50 border border-blue-200 p-4 rounded-lg mb-6">
      <h2 class="font-bold text-blue-900 mb-2">ğŸ” ãƒ†ã‚¹ãƒˆå†…å®¹</h2>
      <p class="text-blue-800 text-sm">
        ã“ã®ãƒšãƒ¼ã‚¸ã¯ã€<code>style="display: none;"</code> ã‚’ <code>class="hidden"</code> ã«ä¿®æ­£ã—ãŸåŠ¹æœã‚’ãƒ†ã‚¹ãƒˆã—ã¾ã™ã€‚
      </p>
      <ul class="list-disc list-inside text-blue-800 text-sm mt-2">
        <li><strong>ä¿®æ­£å‰:</strong> ã‚¤ãƒ³ãƒ©ã‚¤ãƒ³ã‚¹ã‚¿ã‚¤ãƒ« <code>style="display: none;"</code> â†’ JavaScriptã§ <code>classList.remove("hidden")</code> ãŒåŠ¹ã‹ãªã„</li>
        <li><strong>ä¿®æ­£å¾Œ:</strong> Tailwind <code>class="hidden"</code> â†’ JavaScriptã§ <code>classList.remove("hidden")</code> ãŒæ­£å¸¸ã«å‹•ä½œ</li>
      </ul>
    </div>

    <!-- ãƒ†ã‚¹ãƒˆçµæœè¡¨ç¤ºã‚¨ãƒªã‚¢ -->
    <div id="test-results" class="mb-8">
      <h2 class="text-xl font-bold mb-4">ãƒ†ã‚¹ãƒˆçµæœ</h2>
      <div id="results-container"></div>
    </div>

    <!-- ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹1: ä¿®æ­£å‰ï¼ˆstyle="display: none;"ï¼‰ -->
    <div class="bg-white shadow rounded-lg p-6 mb-6">
      <h2 class="text-xl font-bold text-red-600 mb-4">âŒ ä¿®æ­£å‰ã®å®Ÿè£…ï¼ˆå‹•ä½œã—ãªã„ï¼‰</h2>
      <p class="text-gray-600 mb-4">ã‚¤ãƒ³ãƒ©ã‚¤ãƒ³ã‚¹ã‚¿ã‚¤ãƒ« <code>style="display: none;"</code> ã‚’ä½¿ç”¨</p>
      
      <button 
        onclick="showBefore()" 
        class="bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700 mb-4"
      >
        ç§‘ç›®ã‚’é¸æŠï¼ˆä¿®æ­£å‰ã®å‹•ä½œï¼‰
      </button>
      
      <div id="unit-section-before" style="display: none;" class="border-2 border-gray-300 p-4 rounded">
        <p class="text-lg font-bold">ğŸ“Œ å˜å…ƒé¸æŠã‚»ã‚¯ã‚·ãƒ§ãƒ³ï¼ˆä¿®æ­£å‰ï¼‰</p>
        <p class="text-sm text-gray-600">ã“ã®ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã¯è¡¨ç¤ºã•ã‚Œãªã„ã¯ãšã§ã™ï¼ˆãƒã‚°å†ç¾ï¼‰</p>
      </div>
      
      <div id="status-before" class="mt-4 text-sm"></div>
    </div>

    <!-- ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹2: ä¿®æ­£å¾Œï¼ˆclass="hidden"ï¼‰ -->
    <div class="bg-white shadow rounded-lg p-6 mb-6">
      <h2 class="text-xl font-bold text-green-600 mb-4">âœ… ä¿®æ­£å¾Œã®å®Ÿè£…ï¼ˆæ­£å¸¸å‹•ä½œï¼‰</h2>
      <p class="text-gray-600 mb-4">Tailwind <code>class="hidden"</code> ã‚’ä½¿ç”¨</p>
      
      <button 
        onclick="showAfter()" 
        class="bg-green-600 text-white px-6 py-2 rounded-lg hover:bg-green-700 mb-4"
      >
        ç§‘ç›®ã‚’é¸æŠï¼ˆä¿®æ­£å¾Œã®å‹•ä½œï¼‰
      </button>
      
      <div id="unit-section-after" class="hidden border-2 border-gray-300 p-4 rounded">
        <p class="text-lg font-bold">âœ¨ å˜å…ƒé¸æŠã‚»ã‚¯ã‚·ãƒ§ãƒ³ï¼ˆä¿®æ­£å¾Œï¼‰</p>
        <p class="text-sm text-gray-600">ã“ã®ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã¯æ­£å¸¸ã«è¡¨ç¤ºã•ã‚Œã¾ã™ï¼</p>
      </div>
      
      <div id="status-after" class="mt-4 text-sm"></div>
    </div>

    <!-- ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹3: Stimulusã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©ãƒ¼ã®å‹•ä½œç¢ºèª -->
    <div class="bg-white shadow rounded-lg p-6 mb-6" data-controller="test-form-demo">
      <h2 class="text-xl font-bold text-purple-600 mb-4">ğŸ® Stimulusã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©ãƒ¼å‹•ä½œç¢ºèª</h2>
      <p class="text-gray-600 mb-4">å®Ÿéš›ã®Stimulusã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©ãƒ¼ã‚’ä½¿ç”¨ã—ãŸãƒ†ã‚¹ãƒˆ</p>
      
      <div class="mb-4">
        <label class="block text-sm font-bold text-gray-700 mb-2">ç§‘ç›®ã‚’é¸æŠ</label>
        <div class="space-x-4">
          <label class="inline-flex items-center">
            <input 
              type="radio" 
              name="subject" 
              value="english" 
              data-action="change->test-form-demo#onSubjectChange"
              class="mr-2"
            >
            <span>è‹±èª</span>
          </label>
          <label class="inline-flex items-center">
            <input 
              type="radio" 
              name="subject" 
              value="math" 
              data-action="change->test-form-demo#onSubjectChange"
              class="mr-2"
            >
            <span>æ•°å­¦</span>
          </label>
        </div>
      </div>
      
      <div data-test-form-demo-target="unitSection" class="hidden border-2 border-gray-300 p-4 rounded">
        <p class="text-lg font-bold">ğŸ¯ å˜å…ƒé¸æŠï¼ˆStimulusåˆ¶å¾¡ï¼‰</p>
        <p class="text-sm text-gray-600">Stimulusã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©ãƒ¼ã§è¡¨ç¤ºåˆ¶å¾¡ã•ã‚Œã¦ã„ã¾ã™</p>
        <ul class="list-disc list-inside text-sm text-gray-700 mt-2">
          <li>ç¾åœ¨å®Œäº†å½¢</li>
          <li>ä¸å®šè©</li>
          <li>é–¢ä¿‚ä»£åè©</li>
        </ul>
      </div>
      
      <div id="status-stimulus" class="mt-4 text-sm"></div>
    </div>
  </div>

  <script>
    // ãƒ†ã‚¹ãƒˆçµæœã‚’è¨˜éŒ²
    const testResults = [];

    function addTestResult(name, passed, message) {
      testResults.push({ name, passed, message });
      updateTestResults();
    }

    function updateTestResults() {
      const container = document.getElementById('results-container');
      container.innerHTML = testResults.map(result => `
        <div class="test-result ${result.passed ? 'test-pass' : 'test-fail'}">
          <div class="font-bold">${result.passed ? 'âœ…' : 'âŒ'} ${result.name}</div>
          <div class="text-sm mt-1">${result.message}</div>
        </div>
      `).join('');
    }

    // ä¿®æ­£å‰ã®å‹•ä½œãƒ†ã‚¹ãƒˆ
    function showBefore() {
      const section = document.getElementById('unit-section-before');
      const status = document.getElementById('status-before');
      
      // classList.remove("hidden") ã‚’è©¦è¡Œï¼ˆåŠ¹ã‹ãªã„ï¼‰
      section.classList.remove('hidden');
      
      // å®Ÿéš›ã®è¡¨ç¤ºçŠ¶æ…‹ã‚’ç¢ºèª
      const computedStyle = window.getComputedStyle(section);
      const isVisible = computedStyle.display !== 'none';
      
      if (isVisible) {
        status.innerHTML = '<span class="text-green-600 font-bold">âœ… è¡¨ç¤ºæˆåŠŸ</span>';
        addTestResult('ä¿®æ­£å‰ã®å®Ÿè£…', true, 'ã‚¤ãƒ³ãƒ©ã‚¤ãƒ³ã‚¹ã‚¿ã‚¤ãƒ«ãŒå„ªå…ˆã•ã‚Œã€hiddenã‚¯ãƒ©ã‚¹ã®å‰Šé™¤ã¯åŠ¹æœãŒã‚ã‚Šã¾ã›ã‚“ã§ã—ãŸï¼ˆæœŸå¾…é€šã‚Šã®ãƒã‚°å†ç¾ï¼‰');
      } else {
        status.innerHTML = '<span class="text-red-600 font-bold">âŒ è¡¨ç¤ºå¤±æ•—</span> - ã‚¤ãƒ³ãƒ©ã‚¤ãƒ³ã‚¹ã‚¿ã‚¤ãƒ« <code>style="display: none;"</code> ãŒå„ªå…ˆã•ã‚Œã¦ã„ã¾ã™';
        addTestResult('ä¿®æ­£å‰ã®å®Ÿè£…', false, 'ã‚¤ãƒ³ãƒ©ã‚¤ãƒ³ã‚¹ã‚¿ã‚¤ãƒ«ãŒå„ªå…ˆã•ã‚Œã€classList.remove("hidden") ãŒåŠ¹æœãªã— â†’ ã“ã‚ŒãŒå…ƒã®ãƒã‚°');
      }
      
      status.innerHTML += '<br><code>display: ' + computedStyle.display + '</code>';
    }

    // ä¿®æ­£å¾Œã®å‹•ä½œãƒ†ã‚¹ãƒˆ
    function showAfter() {
      const section = document.getElementById('unit-section-after');
      const status = document.getElementById('status-after');
      
      // classList.remove("hidden") ã‚’å®Ÿè¡Œï¼ˆæ­£å¸¸ã«å‹•ä½œï¼‰
      section.classList.remove('hidden');
      
      // å®Ÿéš›ã®è¡¨ç¤ºçŠ¶æ…‹ã‚’ç¢ºèª
      const computedStyle = window.getComputedStyle(section);
      const isVisible = computedStyle.display !== 'none';
      
      if (isVisible) {
        status.innerHTML = '<span class="text-green-600 font-bold">âœ… è¡¨ç¤ºæˆåŠŸ</span> - Tailwindã® <code>hidden</code> ã‚¯ãƒ©ã‚¹ãŒæ­£å¸¸ã«å‹•ä½œã—ã¦ã„ã¾ã™';
        addTestResult('ä¿®æ­£å¾Œã®å®Ÿè£…', true, 'classList.remove("hidden") ãŒæ­£å¸¸ã«å‹•ä½œã—ã€è¦ç´ ãŒè¡¨ç¤ºã•ã‚Œã¾ã—ãŸ âœ…');
      } else {
        status.innerHTML = '<span class="text-red-600 font-bold">âŒ è¡¨ç¤ºå¤±æ•—</span>';
        addTestResult('ä¿®æ­£å¾Œã®å®Ÿè£…', false, 'è¡¨ç¤ºã«å¤±æ•—ã—ã¾ã—ãŸï¼ˆäºˆæœŸã—ãªã„ã‚¨ãƒ©ãƒ¼ï¼‰');
      }
      
      status.innerHTML += '<br><code>display: ' + computedStyle.display + '</code>';
    }

    // Stimulusã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©ãƒ¼ã®ç™»éŒ²
    const application = Stimulus.Application.start();
    
    application.register("test-form-demo", class extends Stimulus.Controller {
      static targets = ["unitSection"]
      
      connect() {
        console.log("âœ… TestFormDemo controller connected");
        document.getElementById('status-stimulus').innerHTML = 
          '<span class="text-green-600 font-bold">âœ… Stimulusã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©ãƒ¼æ¥ç¶šæˆåŠŸ</span>';
        addTestResult('Stimulusã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©ãƒ¼æ¥ç¶š', true, 'ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©ãƒ¼ãŒæ­£å¸¸ã«ç™»éŒ²ãƒ»æ¥ç¶šã•ã‚Œã¾ã—ãŸ');
      }
      
      onSubjectChange(event) {
        console.log("ğŸ“Œ Subject changed:", event.target.value);
        
        if (this.hasUnitSectionTarget) {
          this.unitSectionTarget.classList.remove("hidden");
          
          const computedStyle = window.getComputedStyle(this.unitSectionTarget);
          const isVisible = computedStyle.display !== 'none';
          
          if (isVisible) {
            document.getElementById('status-stimulus').innerHTML = 
              '<span class="text-green-600 font-bold">âœ… Stimulusåˆ¶å¾¡ã§è¡¨ç¤ºæˆåŠŸ</span><br>' +
              '<code>classList.remove("hidden")</code> ãŒæ­£å¸¸ã«å‹•ä½œã—ã¾ã—ãŸ';
            addTestResult('Stimuluså‹•ä½œç¢ºèª', true, 'ç§‘ç›®é¸æŠæ™‚ã«å˜å…ƒã‚»ã‚¯ã‚·ãƒ§ãƒ³ãŒæ­£å¸¸ã«è¡¨ç¤ºã•ã‚Œã¾ã—ãŸ');
          } else {
            document.getElementById('status-stimulus').innerHTML = 
              '<span class="text-red-600 font-bold">âŒ è¡¨ç¤ºå¤±æ•—</span>';
            addTestResult('Stimuluså‹•ä½œç¢ºèª', false, 'è¡¨ç¤ºã«å¤±æ•—ã—ã¾ã—ãŸ');
          }
        }
      }
    });

    // ãƒšãƒ¼ã‚¸ãƒ­ãƒ¼ãƒ‰æ™‚ã®åˆæœŸãƒ¡ãƒƒã‚»ãƒ¼ã‚¸
    window.addEventListener('load', () => {
      console.log("âœ… Test page loaded");
      addTestResult('ãƒšãƒ¼ã‚¸èª­ã¿è¾¼ã¿', true, 'ãƒ†ã‚¹ãƒˆãƒšãƒ¼ã‚¸ãŒæ­£å¸¸ã«èª­ã¿è¾¼ã¾ã‚Œã¾ã—ãŸ');
    });
  </script>
</body>
</html>
